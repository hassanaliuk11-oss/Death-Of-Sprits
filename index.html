<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hassan Jatoi | The Eternal Archive</title>
    
    <!-- External Assets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Cormorant+Garamond:ital,wght@0,300;1,300&family=Marcellus&family=Pinyon+Script&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --gold: #d4af37; 
            --soft-white: #e5e5e5;
            --dark-bg: #050505; 
            --glass: rgba(10, 10, 10, 0.95);
        }
        
        * { cursor: none !important; } /* Custom Cursor Implementation */

        body { 
            background-color: var(--dark-bg); 
            color: var(--soft-white); 
            margin: 0; 
            scroll-behavior: smooth; 
            font-family: 'Marcellus', serif;
            overflow-x: hidden;
            transition: background 1s ease;
        }

        #custom-cursor {
            position: fixed; width: 10px; height: 10px; background: var(--gold);
            border-radius: 50%; pointer-events: none; z-index: 9999;
            transition: transform 0.1s ease, width 0.3s ease, height 0.3s ease, opacity 0.3s ease;
            mix-blend-mode: difference;
        }

        #cursor-ring {
            position: fixed; width: 40px; height: 40px; border: 1px solid var(--gold);
            border-radius: 50%; pointer-events: none; z-index: 9998;
            transition: all 0.15s ease-out;
            opacity: 0.5;
        }

        .bg-vignette {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, transparent 20%, rgba(0,0,0,0.9) 100%);
            z-index: 2; pointer-events: none;
        }

        #dust-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1; opacity: 0.4;
        }

        .nav-bar { 
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(20px);
            position: fixed; top: 0; width: 100%; z-index: 1000; 
            padding: 1.2rem 5%; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(212, 175, 55, 0.15);
        }

        .gold-text {
            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
        }

        .cover-page {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            z-index: 10;
            text-align: center;
            perspective: 1000px;
        }

        .cover-frame {
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 5rem 3rem;
            position: relative;
            max-width: 90%;
            background: rgba(212, 175, 55, 0.02);
            backdrop-filter: blur(5px);
            transition: transform 0.5s ease;
            transform-style: preserve-3d;
        }

        .prose-container { max-width: 850px; margin: 0 auto; padding: 100px 20px; position: relative; z-index: 10; }
        
        .prose-entry { 
            margin-bottom: 150px; padding: 60px 40px;
            background: linear-gradient(145deg, rgba(255,255,255,0.02), rgba(0,0,0,0.2));
            border-radius: 4px; border-left: 1px solid rgba(212,175,55,0.3);
            opacity: 0; transform: translateX(-20px); transition: 1.5s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        
        .prose-entry.visible { opacity: 1; transform: translateX(0); }
        
        .prose-title { 
            font-size: 2.5rem; margin-bottom: 2.5rem; text-align: center; 
            font-family: 'Cinzel Decorative', serif;
            letter-spacing: 4px;
        }

        .typing-title::after {
            content: '|';
            animation: blink 0.7s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        .prose-body { line-height: 2; text-align: center; color: #bbb; white-space: pre-wrap; font-size: 1.1rem; }

        .btn-action {
            background: transparent; border: 1px solid var(--gold); color: var(--gold);
            padding: 10px 22px; font-size: 11px; letter-spacing: 3px;
            text-transform: uppercase; cursor: none; transition: 0.4s;
            border-radius: 2px; position: relative; overflow: hidden;
        }
        .btn-action:hover { background: var(--gold); color: black; box-shadow: 0 0 20px rgba(212, 175, 55, 0.4); }

        .settings-trigger {
            position: fixed; bottom: 40px; right: 40px; z-index: 2000;
            background: black; color: var(--gold);
            width: 65px; height: 65px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 1px solid var(--gold);
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .scroll-progress-ring {
            position: absolute; top: -5px; left: -5px; width: 75px; height: 75px;
            transform: rotate(-90deg); pointer-events: none;
        }
        .scroll-progress-ring circle {
            fill: none; stroke: var(--gold); stroke-width: 2;
            stroke-dasharray: 235.6; stroke-dashoffset: 235.6;
            transition: stroke-dashoffset 0.1s linear;
        }

        .settings-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.96); backdrop-filter: blur(20px);
            z-index: 1999; display: none; align-items: center; justify-content: center;
        }

        .settings-card {
            background: var(--glass); border: 1px solid rgba(212,175,55,0.3);
            padding: 40px; border-radius: 5px; width: 90%; max-width: 400px;
            box-shadow: 0 0 50px rgba(0,0,0,1);
        }

        .audio-wave {
            display: flex; align-items: flex-end; gap: 2px; height: 15px;
        }
        .wave-bar {
            width: 2px; background: var(--gold); animation: wave 1s ease-in-out infinite;
        }
        @keyframes wave {
            0%, 100% { height: 3px; }
            50% { height: 15px; }
        }

        @media (max-width: 768px) {
            .cover-frame { padding: 3rem 1.5rem; }
            .prose-title { font-size: 1.8rem; }
            * { cursor: auto !important; }
            #custom-cursor, #cursor-ring { display: none; }
        }
    </style>
</head>
<body onclick="initAudio()">

    <!-- Custom Cursor -->
    <div id="custom-cursor"></div>
    <div id="cursor-ring"></div>

    <div class="bg-vignette"></div>
    <canvas id="dust-canvas"></canvas>

    <nav class="nav-bar no-print">
        <div class="flex items-center gap-4">
            <div class="flex flex-col">
                <span class="gold-text text-xl tracking-[0.3em] uppercase">Hassan Jatoi</span>
                <span class="text-[8px] opacity-40 tracking-[0.4em]">IMMERSIIVE EXPERIENCE</span>
            </div>
        </div>
        <div class="flex items-center gap-6">
            <div id="audioVisualizer" class="audio-wave opacity-0 transition-opacity duration-500">
                <div class="wave-bar" style="animation-delay: 0.1s"></div>
                <div class="wave-bar" style="animation-delay: 0.3s"></div>
                <div class="wave-bar" style="animation-delay: 0.2s"></div>
                <div class="wave-bar" style="animation-delay: 0.4s"></div>
            </div>
            <button class="btn-action" onclick="toggleAudio()" id="audioStatus">Play</button>
            <button class="btn-action" onclick="downloadPDF()">Export</button>
        </div>
    </nav>

    <div id="capture-area">
        <div class="cover-page" id="parallax-scene">
            <div class="cover-frame shadow-2xl">
                <div class="w-48 h-48 mx-auto rounded-full border border-gold/30 p-2 mb-12 overflow-hidden bg-black/40">
                    <img src="https://i.ibb.co/2YtrCjnY/1000203412.jpg" alt="Hassan Jatoi" class="w-full h-full object-cover grayscale brightness-75 hover:grayscale-0 hover:brightness-100 transition-all duration-1000">
                </div>
                <h1 class="gold-text text-6xl md:text-8xl tracking-[0.4em] uppercase mb-6 drop-shadow-lg">JATOI</h1>
                <div class="h-[1px] w-48 bg-gradient-to-right from-transparent via-gold to-transparent mx-auto mb-8"></div>
                <p class="text-xs tracking-[0.8em] uppercase opacity-50 mb-14 font-light">The Eternal Silence of Soul</p>
                <div class="text-[9px] tracking-[0.3em] uppercase opacity-30 flex flex-col gap-2 italic">
                    <span>Archive Entry No. 1000203412</span>
                    <span>Â© 2024 - Unspoken Legacy</span>
                </div>
            </div>
            <div class="absolute bottom-12 flex flex-col items-center gap-4 no-print opacity-30">
                <span class="text-[8px] tracking-[0.5em] uppercase">Begin Journey</span>
                <div class="w-[1px] h-12 bg-gold/50 animate-pulse"></div>
            </div>
        </div>

        <div id="prose-list" class="prose-container">
            <!-- Dynamic Content -->
        </div>
    </div>

    <!-- Settings & Progress -->
    <div class="settings-trigger no-print" onclick="toggleSettings()" onmouseenter="expandCursor()" onmouseleave="shrinkCursor()">
        <svg class="scroll-progress-ring"><circle id="progressCircle" cx="37.5" cy="37.5" r="37.5"></circle></svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
    </div>

    <div id="settingsMenu" class="settings-overlay no-print" onclick="toggleSettings()">
        <div class="settings-card" onclick="event.stopPropagation()">
            <h3 class="gold-text mb-8 text-center tracking-[0.3em] uppercase text-sm">Library Settings</h3>
            <div class="space-y-8">
                <div>
                    <label class="text-[9px] uppercase tracking-widest text-gold/60 mb-3 block">Typeface Mood</label>
                    <select id="moodSelect" onchange="updateStyles()" class="w-full bg-black border border-gold/20 p-3 text-xs text-white">
                        <option value="'Marcellus', serif">Standard Elegance</option>
                        <option value="'Cinzel Decorative', cursive">Royal Antiquity</option>
                        <option value="'Cormorant Garamond', serif">Poetic Melancholy</option>
                        <option value="'Pinyon Script', cursive">Handwritten Ghost</option>
                    </select>
                </div>
                <div>
                    <label class="text-[9px] uppercase tracking-widest text-gold/60 mb-3 block">Text Magnitude: <span id="sizeVal">18px</span></label>
                    <input type="range" id="sizeSlider" min="14" max="28" value="18" oninput="updateStyles()" class="w-full accent-gold">
                </div>
                <button class="btn-action w-full py-3 mt-4" onclick="toggleSettings()">Return to Archive</button>
            </div>
        </div>
    </div>

    <!-- Hidden Audio Elements -->
    <audio id="pianoAudio" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3"></audio>

    <script>
        const myWork = [
            {
                "title": "The Death of Spirits",
                "text": "The gods have folded their wings and slept,\nLeaving the sky to the birds of prey.\nWhat died within us was not the body,\nBut the light that used to guide the way.\n\nNow we wander in a garden of marble,\nWaiting for a voice that has long since faded."
            },
            {
                "title": "A Symphony of Loss",
                "text": "The house is full of echoes that do not belong to me.\nI hear the turn of a key in a door that has been locked for years.\nThe silence is a heavy shroud, woven from the threads of everything we never said."
            },
            {
                "title": "The Last Ink",
                "text": "If my pen could bleed, the page would be a crimson lake.\nI write to remember what it felt like to be whole.\nNow, I am just a collection of fragments,\nDancing in the wind of a forgotten winter."
            }
        ];

        // Custom Cursor Logic
        const cursor = document.getElementById('custom-cursor');
        const ring = document.getElementById('cursor-ring');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
            ring.style.left = (e.clientX - 15) + 'px';
            ring.style.top = (e.clientY - 15) + 'px';
        });

        function expandCursor() {
            cursor.style.transform = 'scale(4)';
            cursor.style.opacity = '0.3';
            ring.style.transform = 'scale(1.5)';
        }
        function shrinkCursor() {
            cursor.style.transform = 'scale(1)';
            cursor.style.opacity = '1';
            ring.style.transform = 'scale(1)';
        }

        // Typing Effect Logic
        function typeWriter(element, text, i = 0) {
            if (i < text.length) {
                element.innerHTML += text.charAt(i);
                setTimeout(() => typeWriter(element, text, i + 1), 50);
            } else {
                element.classList.remove('typing-title');
            }
        }

        function render() {
            const list = document.getElementById('prose-list');
            list.innerHTML = '';
            myWork.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = 'prose-entry';
                div.innerHTML = `
                    <h2 class="prose-title gold-text" data-title="${item.title}"></h2>
                    <div class="prose-body">${item.text}</div>
                `;
                list.appendChild(div);
            });
            updateStyles();
            observe();
        }

        function observe() {
            const observer = new IntersectionObserver(entries => {
                entries.forEach(e => { 
                    if(e.isIntersecting) {
                        e.target.classList.add('visible');
                        const titleEl = e.target.querySelector('.prose-title');
                        if(titleEl && titleEl.innerHTML === '') {
                            titleEl.classList.add('typing-title');
                            typeWriter(titleEl, titleEl.getAttribute('data-title'));
                        }
                    } 
                });
            }, { threshold: 0.2 });
            document.querySelectorAll('.prose-entry').forEach(el => observer.observe(el));
        }

        // Parallax Effect
        document.addEventListener('mousemove', (e) => {
            const moveX = (e.clientX - window.innerWidth/2) * 0.01;
            const moveY = (e.clientY - window.innerHeight/2) * 0.01;
            const scene = document.getElementById('parallax-scene');
            scene.style.transform = `translate(${moveX}px, ${moveY}px)`;
            
            // Interaction with particles
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        // Audio Management
        const piano = document.getElementById('pianoAudio');
        let audioStarted = false;

        function initAudio() {
            if(!audioStarted) {
                audioStarted = true;
                piano.volume = 0;
                piano.play();
                fadeIn(piano, 0.2);
                document.getElementById('audioStatus').innerText = "Mute";
                document.getElementById('audioVisualizer').classList.remove('opacity-0');
            }
        }

        function toggleAudio() {
            if(piano.paused) {
                piano.play();
                document.getElementById('audioStatus').innerText = "Mute";
                document.getElementById('audioVisualizer').classList.remove('opacity-0');
            } else {
                piano.pause();
                document.getElementById('audioStatus').innerText = "Play";
                document.getElementById('audioVisualizer').classList.add('opacity-0');
            }
        }

        function fadeIn(audio, target) {
            let vol = 0;
            const interval = setInterval(() => {
                if (vol < target) {
                    vol += 0.01;
                    audio.volume = vol;
                } else {
                    clearInterval(interval);
                }
            }, 50);
        }

        // Scroll Progress
        window.onscroll = () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 235.6;
            document.getElementById("progressCircle").style.strokeDashoffset = 235.6 - scrolled;
        };

        // Particles with Mouse Avoidance
        const canvas = document.getElementById('dust-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let mouseX = 0, mouseY = 0;

        function initParticles() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            particles = Array.from({length: 120}, () => ({
                x: Math.random() * canvas.width, y: Math.random() * canvas.height,
                s: Math.random() * 1.5, vx: (Math.random()-0.5)*0.3, vy: (Math.random()-0.5)*0.3,
                originX: 0, originY: 0
            }));
        }

        function animate() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach(p => {
                // Avoid Mouse Logic
                const dx = mouseX - p.x;
                const dy = mouseY - p.y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                if(dist < 100) {
                    p.x -= dx * 0.02;
                    p.y -= dy * 0.02;
                }

                ctx.beginPath();
                ctx.fillStyle = `rgba(212,175,55,${Math.random() * 0.2 + 0.1})`;
                ctx.arc(p.x, p.y, p.s, 0, Math.PI*2);
                ctx.fill();
                
                p.x+=p.vx; p.y+=p.vy;
                if(p.x<0)p.x=canvas.width; if(p.x>canvas.width)p.x=0;
                if(p.y<0)p.y=canvas.height; if(p.y>canvas.height)p.y=0;
            });
            requestAnimationFrame(animate);
        }

        function toggleSettings() {
            const menu = document.getElementById('settingsMenu');
            menu.style.display = (menu.style.display === 'flex') ? 'none' : 'flex';
        }

        function updateStyles() {
            const font = document.getElementById('moodSelect').value;
            const size = document.getElementById('sizeSlider').value;
            document.getElementById('sizeVal').innerText = size + 'px';
            document.querySelectorAll('.prose-body').forEach(el => {
                el.style.fontFamily = font;
                el.style.fontSize = size + 'px';
            });
        }

        function downloadPDF() {
            const element = document.getElementById('capture-area');
            html2pdf().from(element).set({
                margin: 5, filename: 'Hassan_Jatoi_Archive.pdf',
                html2canvas: { scale: 2, backgroundColor: '#050505' }, 
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            }).save();
        }

        window.onload = () => { render(); initParticles(); animate(); };
        window.onresize = initParticles;
    </script>
</body>
</html>
